{% extends "sidebar.html" %}
{% block content %}

<h2>Create Task</h2>
<form method="POST">
    <label>Title</label>
    <input type="text" name="title" required><br><br>

    <label>Description</label>
    <textarea name="description"></textarea><br><br>

    <label>Due Date</label>
    <input type="date" name="due_date"><br><br>

    <label>Priority</label>
    <select name="priority">
        <option value="high">High</option>
        <option value="medium" selected>Medium</option>
        <option value="low">Low</option>
    </select><br><br>

    <label>Assign To</label>
    <select name="assigned_to">
        <option value="">Self</option>
        {% for user in users %}
        <option value="{{ user.id }}">{{ user.name }}</option>
        {% endfor %}
    </select><br><br>

    <button type="submit">Create Task</button>
</form>

<div class="tasks-card">
    {% for task in tasks %}
    <div class="task-row" data-detail="{{ url_for('task_bp.task_detail', task_id=task.id) }}">
        <div><input type="checkbox" class="task-checkbox" {% if task.status=='completed' %}checked{% endif %} /></div>
        <div class="task-content">
            <div class="task-title">{{ task.title }}</div>
            <div class="task-desc">{{ task.description }}</div>
            <div class="task-meta">
                <div class="meta-item">ðŸ“… Due {{ task.due_date }}</div>
                <div class="meta-item">ðŸ‘¤ Assigned to {{ task.assigned_name or 'You' }}</div>
            </div>
        </div>
        <div style="display:flex;flex-direction:column;align-items:flex-end;gap:10px">
            <div class="priority {{ task.priority }}">{{ task.priority|capitalize }}</div>
        </div>
        <div style="margin-left:10px;display:flex;flex-direction:column;gap:5px">
            <a href="{{ url_for('task_bp.complete_task', task_id=task.id) }}" style="color:green;font-size:14px">âœ” Complete</a>
            {% if task.created_by == session.get('user_id') %}
            <a href="{{ url_for('task_bp.delete_task', task_id=task.id) }}" style="color:red;font-size:14px">ðŸ—‘ Delete</a>
            {% endif %}
        </div>
    </div>
    {% else %}
    <div>No tasks found.</div>
    {% endfor %}
</div>

{% endblock %}
